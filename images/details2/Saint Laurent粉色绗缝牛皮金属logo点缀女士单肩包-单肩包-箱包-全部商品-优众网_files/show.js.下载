!function(){function a(){return q.length-5}function b(){if(a()<=0)return s.addClass("failed"),void t.addClass("failed");A<=0?(t.addClass("failed"),s.removeClass("failed")):A==a()?(s.addClass("failed"),t.removeClass("failed")):A>0&&A<a()&&(s.removeClass("failed"),t.removeClass("failed"))}function c(){var a=$(".pro_btn"),b=a.find(".purchase"),c=a.find(".add_cart"),d=a.find(".sold_out");m<1?(b.addClass("hide"),c.addClass("hide"),d.removeClass("hide")):(b.removeClass("hide"),c.removeClass("hide"),d.addClass("hide"))}function d(a){m<=1?(u.addClass("failed"),v.addClass("failed")):a<=1?(u.addClass("failed"),v.removeClass("failed")):a<m?(u.removeClass("failed"),v.removeClass("failed")):(u.removeClass("failed"),v.addClass("failed")),e(a)}function e(a){if(o&&1!=o&&13!=o&&a>1){1*n*a>2e3?($(".pro_btn .purchase").addClass("disable"),$(".pro_values .beyond_tax_error").removeClass("hide")):($(".pro_btn .purchase").removeClass("disable"),$(".pro_values .beyond_tax_error").addClass("hide"))}else $(".pro_btn .purchase").removeClass("disable"),$(".pro_values .beyond_tax_error").addClass("hide")}function f(){if(i()){var a={product_id:l,count_products:$(".count .num").html()};h()&&(a.measure=h()),app.add_cart(a,function(a){a&&(alert("成功加入购物车"),window.location.reload())})}else alert("请选择尺码")}function g(){var a="/trades/create?id="+l+"&quantity="+$(".count .num").html()||1;console.log(a),i()?(h()&&(a+="&measure="+h()),window.location.href=a):alert("请选择尺码")}function h(){return $(".size .val.active").data("size")}function i(){return!($(".size").length>0&&0==$(".size .val.active").length)}$(".content .show").removeClass("hide"),app.lazy_load($("img"));var j=$(".product_content"),l=j.data("product-id"),m=j.data("product-count"),n=j.data("discount"),o=j.data("location-id"),p=$(".small_imgs .imgs"),q=$(".imgss"),r=q.width()+q.delpx_css("margin-left"),s=$(".btn_left"),t=$(".btn_right"),u=($(".slide_img"),$(".minus")),v=$(".plus"),w=$(".pic_zoom"),x=$(".slide_img .zoom"),y=$(".qrcode_wrap"),z=$(".summary_mbuy");NTKF_PARAM.itemid=l,$(".slidimg").on("mouseover",function(a){w.removeClass("hide"),x.removeClass("hide")}),$(".slidimg").on("mouseout",function(){w.addClass("hide"),x.addClass("hide")}),$(".slidimg").on("mousemove",function(a){var b=a.pageX-$(this).offset().left-$(this).find(".zoom").outerWidth()/2,c=a.pageY-$(this).offset().top-$(this).find(".zoom").outerHeight()/2;b<0?b=0:b>$(this).outerWidth()-$(this).find(".zoom").outerWidth()&&(b=$(this).outerWidth()-$(this).find(".zoom").outerWidth()),c<0?c=0:c>$(this).outerHeight()-$(this).find(".zoom").outerHeight()&&(c=$(this).outerHeight()-$(this).find(".zoom").outerHeight());var d=(w.find("img").outerWidth()-w.outerWidth())*b/($(this).find(".zoom").outerWidth()-$(this).outerWidth()),e=(w.find("img").outerHeight()-w.outerHeight())*c/($(this).find(".zoom").outerHeight()-$(this).outerHeight());$(this).find(".zoom").css({left:b+"px",top:c+"px"}),w.find("img").css({left:d+"px",top:e+"px"})}),y.on("mouseenter",function(a){$(this).addClass("active"),z.removeClass("hide")}),y.on("mouseleave",function(a){k=setTimeout(function(){y.removeClass("active"),z.addClass("hide")},100)}),z.on("mouseenter",function(a){clearTimeout(k)}),z.on("mouseleave",function(a){y.removeClass("active"),z.addClass("hide")}),p.width(q.length*r);var A=a();b(),$(".pro_values .size").length>0&&$.each($(".vals .val"),function(a,b){$(b).hasClass("failed")||$(b).siblings().hasClass("active")||($(b).addClass("active"),m=$(b).data("count"))}),d(parseInt($(".count .num").html())),c(),$(".imgs").mouseover(function(){var a=$(this).find("img").data("large-src"),b=$(this).find("img").data("big-src"),c=$(".slide_img");a!=c.find("img").data("src")&&(c.removeClass("loaded"),w.removeClass("loaded"),c.find("img").replaceWith("<img data-src="+a+" alt>"),w.find("img").replaceWith("<img data-src="+b+" alt>"),app.lazy_load($(".slide_img img")),app.lazy_load($(".pic_zoom img")),$(this).addClass("active").siblings().removeClass("active"))}),t.on("click",function(){var a=p.delpx_css("left");$(this).hasClass("failed")||(A--,p.animate({left:-r+a+"px"},150),b())}),s.on("click",function(){var a=p.delpx_css("left");$(this).hasClass("failed")||(A++,p.animate({left:r+a+"px"},150),b())}),$(".size .val").on("click",function(){$(this).hasClass("failed")||(m=$(this).data("count"),$(".count .num").html(1),d(parseInt($(".count .num").html())),c(),$(this).toggleClass("active").siblings().removeClass("active"))}),u.on("click",function(){var a=parseInt($(".count .num").html());$(this).hasClass("failed")||(a--,d(a),$(".count .num").html(a))}),v.on("click",function(){var a=parseInt($(".count .num").html());$(this).hasClass("failed")||(a++,d(a),$(".count .num").html(a))}),$(".add_cart").on("click",function(){app.check_login()?f():app.login_idialog(function(){f()})}),$(".purchase").on("click",function(){$(this).hasClass("disable")||(app.check_login()?g():app.login_idialog(function(){g()}))})}();